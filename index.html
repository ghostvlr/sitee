<!DOCTYPE html>
<html>
<head>
	<title>Kayıt Ol</title>
	<link rel="stylesheet" type="text/css" href="/css/kayit.css">
	<link rel="shortcut icon" href="images/signup.png" type="image/x-icon">

</head>
<body>
	<div class="main">  	
		<input type="checkbox" id="chk" aria-hidden="true">

			<div class="signup">
				<form>
					<label for="chk" aria-hidden="true">Kayıt Ol</label>
					<!-- <input type="text" name="txt" id="txt" placeholder="Kullanıcı Adı" required=""> -->
					<input type="email" name="email" id="email" placeholder="E-Posta" required="">
					<input type="password" name="password" id="password" placeholder="Şifre" required="">
					<button type="button" id="register" name="register" class="btn btn-success">Şimdi Kayıt Ol</button>
					<a href="forgot.html" target="_blank"><p id="pass">Şifremi Unuttum</p></a>
				</form>
			</div>

			<div class="login">
				<form>
					<label for="chk" aria-hidden="true">Giriş</label>
					<!-- <input type="text" name="telno" id="telno" placeholder="telefon numarası" required=""> -->
					<input type="email" name="login_email" id="login_email" placeholder="E-Posta" required="">
					<input type="password" name="login_password" id="login_password" placeholder="Şifre" required="">
					<button type="button" id="login" name="login_password" class="btn btn-success">Giriş Yap</button>
					
				</form>
			</div>
</body>
<script type="module">
	// Import the functions you need from the SDKs you need
	import { initializeApp } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-analytics.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-auth.js";
	// TODO: Add SDKs for Firebase products that you want to use
	// https://firebase.google.com/docs/web/setup#available-libraries

	// Your web app's Firebase configuration
	// For Firebase JS SDK v7.20.0 and later, measurementId is optional
	const firebaseConfig = {
		  apiKey: "AIzaSyCpnsiRtyvChGxPQ_IzjO6qHazrT2zkNuQ",
		  authDomain: "chat-6af43.firebaseapp.com",
		  databaseURL: "https://chat-6af43-default-rtdb.firebaseio.com",
		  projectId: "chat-6af43",
		  storageBucket: "chat-6af43.appspot.com",
		  messagingSenderId: "381364988848",
		  appId: "1:381364988848:web:40128e3382a89300010475"
	  };

	// Initialize Firebase
	const app = initializeApp(firebaseConfig);
	const analytics = getAnalytics(app);
	const auth = getAuth();
	console.log(app);
	

	//----- New Registration code start	  
	document.getElementById("register").addEventListener("click", function() {
	
		var email =  document.getElementById("email").value;
		var password = document.getElementById("password").value;		
		
		//For new registration
		createUserWithEmailAndPassword(auth,email, password)
		.then((userCredential) => {
		  // Signed in 
		  const user = userCredential.user;
		  alert("Kayıt Başarılı");
		  // ...
		})
		.catch((error) => {
		  const errorCode = error.code;
		  const errorMessage = error.message;
		  // ..
		  console.log(errorMessage);
		  alert(error);
		});		  		  
	});
	//----- End

	//----- Login code start	  
	document.getElementById("login").addEventListener("click", function() {
		var email =  document.getElementById("login_email").value;
		var password = document.getElementById("login_password").value;
	
		

		signInWithEmailAndPassword(auth,email, password)
		.then((userCredential) => {
		  // Signed in 
		  const user = userCredential.user;
		  alert("Giriş Başarılı Yönlendiriliyor");
		  window.location.href="/chat.html";
		  localStorage.setItem('login_password',password);
		  localStorage.setItem('email', email);

		  // document.getElementById('logout').style.display = 'block';
		  // ...
		})
		.catch((error) => {
		  const errorCode = error.code;
		  const errorMessage = error.message;
		  console.log(errorMessage);
		  alert(errorMessage);
		});		  		  
	});
	//----- End

	//----- Logout code start	  
	document.getElementById("logout").addEventListener("click", function() {
		signOut(auth).then(() => {
			// Sign-out successful.
			console.log('Sign-out successful.');
			alert('Sign-out successful.');
			document.getElementById('logout').style.display = 'none';
		  }).catch((error) => {
			// An error happened.
			console.log('An error happened.');
		  });		  		  
	});
	//----- End

	

  </script>
</html>